"use strict";(self.webpackChunk_gorules_jdm_editor=self.webpackChunk_gorules_jdm_editor||[]).push([[517],{"./src/components/table/table.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,__namedExportsOrder:()=>__namedExportsOrder,default:()=>table_stories});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),UndoOutlined=__webpack_require__("./node_modules/@ant-design/icons/es/icons/UndoOutlined.js"),ExportOutlined=__webpack_require__("./node_modules/@ant-design/icons/es/icons/ExportOutlined.js"),ImportOutlined=__webpack_require__("./node_modules/@ant-design/icons/es/icons/ImportOutlined.js"),space=__webpack_require__("./node_modules/antd/es/space/index.js"),es_button=__webpack_require__("./node_modules/antd/es/button/index.js"),es_select=__webpack_require__("./node_modules/antd/es/select/index.js"),regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),immer_esm=__webpack_require__("./node_modules/immer/dist/immer.esm.js"),index_browser=__webpack_require__("./node_modules/nanoid/index.browser.js"),papaparse_min=__webpack_require__("./node_modules/papaparse/papaparse.min.js"),papaparse_min_default=__webpack_require__.n(papaparse_min),saveFile=function saveFile(filename,contents){var element=document.createElement("a");element.download=filename,element.href=URL.createObjectURL(contents),element.style.display="none",document.body.appendChild(element),element.click(),element.remove()};(0,immer_esm.vI)();var TableContext=react.createContext({}),parserOptions={delimiter:";"},useTable=function useTable(){return react.useContext(TableContext)};const table_context=function TableProvider(props){var _decisionTable$inputs,_decisionTable$output,id=props.id,name=props.name,_props$namespace=props.namespace,namespace=void 0===_props$namespace?"default":_props$namespace,children=props.children,activeRules=props.activeRules,configurable=props.configurable,disabled=props.disabled,onChange=props.onChange,defaultDecisionTable=props.value,fileInput=(0,react.useRef)(null),_useState=(0,react.useState)(""),_useState2=(0,slicedToArray.Z)(_useState,2),inputValue=_useState2[0],setInputValue=_useState2[1],_useState3=(0,react.useState)(null),_useState4=(0,slicedToArray.Z)(_useState3,2),cursor=_useState4[0],setCursor=_useState4[1],_useState5=(0,react.useState)(!1),_useState6=(0,slicedToArray.Z)(_useState5,2),editing=_useState6[0],setEditing=_useState6[1],cells=(0,react.useRef)({}),table=(0,react.useRef)(null),actionStack=(0,react.useRef)({future:[],past:[]}),_useState7=(0,react.useState)({hitPolicy:(null==defaultDecisionTable?void 0:defaultDecisionTable.hitPolicy)||"first",inputs:(null==defaultDecisionTable?void 0:defaultDecisionTable.inputs)||[],outputs:(null==defaultDecisionTable?void 0:defaultDecisionTable.outputs)||[],rules:(null==defaultDecisionTable?void 0:defaultDecisionTable.rules)||[]}),_useState8=(0,slicedToArray.Z)(_useState7,2),decisionTable=_useState8[0],setDecisionTable=_useState8[1],inputs=(null==decisionTable||null===(_decisionTable$inputs=decisionTable.inputs)||void 0===_decisionTable$inputs?void 0:_decisionTable$inputs.length)>0?(null==decisionTable?void 0:decisionTable.inputs)||[]:[{id:"".concat(id,"_input"),name:"No Inputs",type:""}],outputs=(null==decisionTable||null===(_decisionTable$output=decisionTable.outputs)||void 0===_decisionTable$output?void 0:_decisionTable$output.length)>0?(null==decisionTable?void 0:decisionTable.outputs)||[]:[{id:"".concat(id,"_output"),name:"No Outputs",type:""}],cleanupTableRule=function cleanupTableRule(rule){var schemaItems=[].concat((0,toConsumableArray.Z)(decisionTable.inputs),(0,toConsumableArray.Z)(decisionTable.outputs)),newRule={_id:rule._id||(0,index_browser.x0)(10),_description:rule._description};return schemaItems.forEach((function(schemaItem){newRule[schemaItem.id||""]=(null==rule?void 0:rule[schemaItem.id||""])||""})),newRule},cleanupTableRules=function cleanupTableRules(decisionTable){var rules=(null==decisionTable?void 0:decisionTable.rules)||[],schemaItems=[].concat((0,toConsumableArray.Z)(decisionTable.inputs),(0,toConsumableArray.Z)(decisionTable.outputs));return rules.map((function(rule){var newRule={_id:rule._id||(0,index_browser.x0)(10),_description:rule._description};return schemaItems.forEach((function(schemaItem){newRule[schemaItem.id||""]=(null==rule?void 0:rule[schemaItem.id||""])||""})),newRule}))};(0,react.useEffect)((function(){null==onChange||onChange(decisionTable)}),[decisionTable]);var getColumnId=function getColumnId(x){var _ref,_ref$x;return(null===(_ref=[].concat((0,toConsumableArray.Z)(inputs),(0,toConsumableArray.Z)(outputs)))||void 0===_ref||null===(_ref$x=_ref[x])||void 0===_ref$x?void 0:_ref$x.id)||null},patchListener=function patchListener(patches,inversePatches){actionStack.current.future=[],actionStack.current.past=actionStack.current.past.reverse().slice(0,10).reverse(),actionStack.current.past.push({patches,inversePatches})},trySetCursor=function trySetCursor(newCursor){var _decisionTable$rules2,x=newCursor.x,y=newCursor.y;return!!getColumnId(x)&&(!(null==decisionTable||null===(_decisionTable$rules2=decisionTable.rules)||void 0===_decisionTable$rules2||!_decisionTable$rules2[y])&&(setCursor(newCursor),!0))},getElementsFromEvent=function getElementsFromEvent(e){var target=e.target,cell=target.hasAttribute("data-table-cell")?target:target.closest("[data-table-cell]");return cell?{cell}:null},exportCsv=function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(options){var name,schemaMeta,schemaItems,formatted,csv,blob;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:name=options.name,schemaMeta=[].concat((0,toConsumableArray.Z)(inputs.map((function(input){return[input.name,input.field,"INPUT",input.id].join(" | ")}))),(0,toConsumableArray.Z)(outputs.map((function(output){return[output.name,output.field,"OUTPUT",output.id,output.type].join(" | ")})))),schemaItems=[].concat((0,toConsumableArray.Z)(inputs),(0,toConsumableArray.Z)(outputs)),formatted=null==decisionTable?void 0:decisionTable.rules.map((function(record){var newDataPoint=[];return schemaItems.forEach((function(schemaItem){var val=null==record?void 0:record[schemaItem.id||""],formattedVal="object"==typeof val&&null!==val?JSON.stringify(val):val;newDataPoint.push(formattedVal||"")})),newDataPoint})),csv=papaparse_min_default().unparse({fields:schemaMeta,data:formatted},(0,objectSpread2.Z)((0,objectSpread2.Z)({},parserOptions),{},{header:!0})),blob=new Blob([csv],{type:"text/csv"}),saveFile("".concat(name,".csv"),blob);case 7:case"end":return _context.stop()}}),_callee)})));return function exportCsv(_x){return _ref2.apply(this,arguments)}}(),handleCsv=function(){var _ref3=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(content){var _spreadsheetData$spli,spreadsheetData,headers,columns,inputs,outputs,rules;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,new Promise((function(resolve,reject){return papaparse_min_default().parse(content,(0,objectSpread2.Z)((0,objectSpread2.Z)({},parserOptions),{},{header:!1,complete:function complete(results){if(results.errors.length)return reject("failed to parse csv file");resolve(results.data)}}))}));case 2:spreadsheetData=_context2.sent,headers=null==spreadsheetData||null===(_spreadsheetData$spli=spreadsheetData.splice(0,1))||void 0===_spreadsheetData$spli?void 0:_spreadsheetData$spli[0],columns=headers.map((function(header){var _header$split$map=header.split(" | ").map((function(s){return(s||"").trim()})),_header$split$map2=(0,slicedToArray.Z)(_header$split$map,5),name=_header$split$map2[0],field=_header$split$map2[1],_type=_header$split$map2[2],id=_header$split$map2[3];return{name,field,_type,type:_header$split$map2[4]||"expression",id}})),inputs=columns.filter((function(column){return"INPUT"===column._type})).map((function(column){return{id:column.id,name:null==column?void 0:column.name,field:null==column?void 0:column.field,type:null==column?void 0:column.type}})),outputs=columns.filter((function(column){return"OUTPUT"===column._type})).map((function(column){return{id:column.id,name:null==column?void 0:column.name,field:null==column?void 0:column.field,type:null==column?void 0:column.type}})),rules=spreadsheetData.map((function(data){var dataPoint={_id:(0,index_browser.x0)(10)};return columns.forEach((function(col,index){dataPoint[col.id]=(null==data?void 0:data[index])||""})),dataPoint})),setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft.inputs=inputs,draft.outputs=outputs,draft.rules=rules,draft}),patchListener));case 9:case"end":return _context2.stop()}}),_callee2)})));return function handleCsv(_x2){return _ref3.apply(this,arguments)}}(),handleUploadInput=function(){var _ref4=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee3(event){var _event$target,_Array$from,fileList,reader;return(0,regeneratorRuntime.Z)().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:fileList=null==event||null===(_event$target=event.target)||void 0===_event$target?void 0:_event$target.files,(reader=new FileReader).onload=function(e){var _target;handleCsv(null==e||null===(_target=e.target)||void 0===_target?void 0:_target.result)},reader.readAsText(null===(_Array$from=Array.from(fileList))||void 0===_Array$from?void 0:_Array$from[0]);case 4:case"end":return _context3.stop()}}),_callee3)})));return function handleUploadInput(_x3){return _ref4.apply(this,arguments)}}();return react.createElement(TableContext.Provider,{value:{id,name,cursor,setCursor,trySetCursor,value:decisionTable,actionStack:actionStack.current,inputs,outputs,namespace,editing,setEditing:function _setEditing(value){if(value!==editing){if(value&&cursor){var _decisionTable$rules,_decisionTable$rules$,columnId=getColumnId(cursor.x);setInputValue(columnId&&(null==decisionTable||null===(_decisionTable$rules=decisionTable.rules)||void 0===_decisionTable$rules||null===(_decisionTable$rules$=_decisionTable$rules[cursor.y])||void 0===_decisionTable$rules$?void 0:_decisionTable$rules$[columnId])||"")}setEditing(value)}},inputValue,setInputValue,getElementsFromEvent,getCursorFromEvent:function getCursorFromEvent(e){var elements=getElementsFromEvent(e);if(!elements)return null;var cell=elements.cell;return{x:Number.parseInt(cell.getAttribute("data-x"),10),y:Number.parseInt(cell.getAttribute("data-y"),10)}},isLastElementFromEvent:function isLastElementFromEvent(e){var _decisionTable$rules3,elements=getElementsFromEvent(e);if(!elements)return!1;var cell=elements.cell;return Number.parseInt(cell.getAttribute("data-y")||"",10)===(null==decisionTable||null===(_decisionTable$rules3=decisionTable.rules)||void 0===_decisionTable$rules3?void 0:_decisionTable$rules3.length)},isContentElementFromEvent:function isContentElementFromEvent(e){var elements=getElementsFromEvent(e);return!!elements&&"content"===elements.cell.getAttribute("data-type")},getCell:function getCell(cursor){var _cells$current;if(!cursor)return null;var x=cursor.x,y=cursor.y,columnId=getColumnId(x);if(!columnId)return null;var cell=null===(_cells$current=cells.current)||void 0===_cells$current?void 0:_cells$current["".concat(y,":").concat(columnId)];return cell||null},cells,table,commitData:function commitData(value,cursor){var x=cursor.x,y=cursor.y,column=getColumnId(x);column&&setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft.rules[y][column]=value,draft}),patchListener))},swapRows:function swapRows(source,target){setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){var _draft$rules,input=null==draft||null===(_draft$rules=draft.rules)||void 0===_draft$rules?void 0:_draft$rules[source];return draft.rules.splice(source,1),draft.rules.splice(target,0,input),draft}),patchListener)),setCursor(null)},addRowAbove:function addRowAbove(target){setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft.rules.splice(target,0,cleanupTableRule({_id:(0,index_browser.x0)(10)})),draft}),patchListener)),setCursor((function(cursor){return cursor?(0,objectSpread2.Z)((0,objectSpread2.Z)({},cursor),{},{y:cursor.y+1}):null}))},addRowBelow:function addRowBelow(target){target+=1,setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft.rules.splice(target,0,cleanupTableRule({_id:(0,index_browser.x0)(10)})),draft}),patchListener))},removeRow:function removeRow(target){setCursor(null),setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft.rules.splice(target,1),draft}),patchListener)),cursor&&(trySetCursor({x:cursor.x,y:cursor.y-1})||trySetCursor({x:cursor.x,y:cursor.y}))},addColumn:function addColumn(type,column){setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft[type].push(column),draft.rules=cleanupTableRules(draft),draft}),patchListener))},removeColumn:function removeColumn(type,id){setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft[type]=((null==draft?void 0:draft[type])||[]).filter((function(item){return(null==item?void 0:item.id)!==id})),draft.rules=cleanupTableRules(draft),draft}),patchListener)),setCursor(null)},updateColumn:function updateColumn(type,id,data){setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft[type]=draft[type].map((function(item){return item.id===id?(0,objectSpread2.Z)((0,objectSpread2.Z)({},item),{},{name:null==data?void 0:data.name,field:null==data?void 0:data.field}):item})),draft.rules=cleanupTableRules(draft),draft}),patchListener))},reorderColumns:function reorderColumns(type,columns){setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft[type]=columns,draft.rules=cleanupTableRules(draft),draft}),patchListener))},updateHitPolicy:function updateHitPolicy(hitPolicy){setDecisionTable((0,immer_esm.ZP)(decisionTable,(function(draft){return draft.hitPolicy=hitPolicy,draft}),patchListener))},getColumnId,undo:function undo(){var action=actionStack.current.past.pop();action&&(actionStack.current.future.push(action),setDecisionTable((function(data){return(0,immer_esm.QE)(data,action.inversePatches)})))},redo:function redo(){var action=actionStack.current.future.pop();action&&(actionStack.current.past.push(action),setDecisionTable((function(data){return(0,immer_esm.QE)(data,action.patches)})))},importCsv:function importCsv(){var _fileInput$current,_fileInput$current$cl;null==fileInput||null===(_fileInput$current=fileInput.current)||void 0===_fileInput$current||null===(_fileInput$current$cl=_fileInput$current.click)||void 0===_fileInput$current$cl||_fileInput$current$cl.call(_fileInput$current)},exportCsv,activeRules,disabled,configurable}},react.createElement("input",{multiple:!0,hidden:!0,accept:".csv",type:"file",ref:fileInput,onChange:handleUploadInput,onClick:function onClick(event){event.target.value=null}}),children)};try{tablecontext.displayName="tablecontext",tablecontext.__docgenInfo={description:"",displayName:"tablecontext",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"TableProps"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((decisionTable: TableProps) => void)"}},namespace:{defaultValue:null,description:"",name:"namespace",required:!1,type:{name:"string"}},activeRules:{defaultValue:null,description:"",name:"activeRules",required:!1,type:{name:"string[]"}},configurable:{defaultValue:null,description:"",name:"configurable",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table.context.tsx#tablecontext"]={docgenInfo:tablecontext.__docgenInfo,name:"tablecontext",path:"src/components/table/table.context.tsx#tablecontext"})}catch(__react_docgen_typescript_loader_error){}const table_command_bar=function TableCommandBar(){var _useTable=useTable(),name=_useTable.name,undo=_useTable.undo,redo=_useTable.redo,actionStack=_useTable.actionStack,value=_useTable.value,updateHitPolicy=_useTable.updateHitPolicy,disabled=_useTable.disabled,configurable=_useTable.configurable,exportCsv=_useTable.exportCsv,importCsv=_useTable.importCsv;return react.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0.5rem",borderBottom:"1px solid #f0f2f5"}},react.createElement(space.Z,{size:0,className:"full-width"},react.createElement(es_button.ZP,{type:"link",icon:react.createElement(UndoOutlined.Z,{style:{color:"var(--ant-primary-color)"}}),disabled:!actionStack.past.length,onClick:undo},"Undo"),react.createElement(es_button.ZP,{type:"link",color:"secondary",icon:react.createElement(UndoOutlined.Z,{style:{color:"var(--ant-primary-color)"}}),disabled:!actionStack.future.length,onClick:redo},"Redo"),react.createElement(es_button.ZP,{type:"link",color:"secondary",icon:react.createElement(ExportOutlined.Z,{style:{color:"var(--ant-primary-color)"}}),onClick:function onClick(){return exportCsv({name})}},"Export CSV"),react.createElement(es_button.ZP,{type:"link",color:"secondary",icon:react.createElement(ImportOutlined.Z,{style:{color:"var(--ant-primary-color)"}}),onClick:function onClick(){return importCsv()}},"Upload CSV")),react.createElement(es_select.Z,{style:{width:140},disabled:disabled||!configurable,value:null==value?void 0:value.hitPolicy,options:[{key:"first",label:"First",value:"first"},{key:"collect",label:"Collect",value:"collect"}],onSelect:updateHitPolicy}))};try{tablecommandbar.displayName="tablecommandbar",tablecommandbar.__docgenInfo={description:"",displayName:"tablecommandbar",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-command-bar.tsx#tablecommandbar"]={docgenInfo:tablecommandbar.__docgenInfo,name:"tablecommandbar",path:"src/components/table/table-command-bar.tsx#tablecommandbar"})}catch(__react_docgen_typescript_loader_error){}var TableDialogContext=react.createContext({}),TableDialogProvider=function TableDialogProvider(_ref){var children=_ref.children,_useState=(0,react.useState)(void 0),_useState2=(0,slicedToArray.Z)(_useState,2),dialog=_useState2[0],setDialog=_useState2[1];return react.createElement(TableDialogContext.Provider,{value:{dialog,setDialog,isDialogActive:function isDialogActive(type){return(null==dialog?void 0:dialog.type)===type}}},children)},useTableDialog=function useTableDialog(){return react.useContext(TableDialogContext)};try{TableDialogProvider.displayName="TableDialogProvider",TableDialogProvider.__docgenInfo={description:"",displayName:"TableDialogProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-dialog.context.tsx#TableDialogProvider"]={docgenInfo:TableDialogProvider.__docgenInfo,name:"TableDialogProvider",path:"src/components/table/table-dialog.context.tsx#TableDialogProvider"})}catch(__react_docgen_typescript_loader_error){}var es_form=__webpack_require__("./node_modules/antd/es/form/index.js"),modal=__webpack_require__("./node_modules/antd/es/modal/index.js"),input=__webpack_require__("./node_modules/antd/es/input/index.js"),slugify=__webpack_require__("./node_modules/slugify/slugify.js"),slugify_default=__webpack_require__.n(slugify),FieldAdd=function FieldAdd(props){var isOpen=props.isOpen,onDismiss=props.onDismiss,onSuccess=props.onSuccess,_Form$useForm=es_form.Z.useForm(),form=(0,slicedToArray.Z)(_Form$useForm,1)[0],name=es_form.Z.useWatch("name",form),type=es_form.Z.useWatch("type",form);return(0,react.useEffect)((function(){isOpen&&form.resetFields()}),[isOpen,form]),(0,react.useEffect)((function(){if(!form.isFieldTouched("field")&&name){var parsed=slugify_default()(name,{replacement:".",remove:void 0,lower:!0});form.setFields([{name:"field",value:parsed,touched:!1}])}}),[name,form]),react.createElement(modal.Z,{title:"Add a column",open:isOpen,destroyOnClose:!0,onCancel:onDismiss,width:360,okText:"Add",okButtonProps:{form:"field-add-dialog",htmlType:"submit"}},react.createElement(es_form.Z,{id:"field-add-dialog",requiredMark:!1,form,layout:"vertical",initialValues:{type:"expression"},onFinish:function onFinish(_ref){var type=_ref.type,field=_ref.field,name=_ref.name;null==onSuccess||onSuccess({id:(0,index_browser.x0)(10),type:type||"expression",field,name})}},react.createElement(es_form.Z.Item,{name:"name",label:"Label",rules:[{required:!0}]},react.createElement(input.Z,{autoComplete:"off"})),react.createElement(es_form.Z.Item,{name:"field",label:"expression"===type?"Selector":"Field",rules:[{required:!0}]},react.createElement(input.Z,{autoComplete:"off"}))))};try{FieldAdd.displayName="FieldAdd",FieldAdd.__docgenInfo={description:"",displayName:"FieldAdd",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},onSuccess:{defaultValue:null,description:"",name:"onSuccess",required:!1,type:{name:"((column: TableSchemaItem) => void)"}},onDismiss:{defaultValue:null,description:"",name:"onDismiss",required:!1,type:{name:"(() => void)"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!1,type:{name:"boolean"}},columnType:{defaultValue:null,description:"",name:"columnType",required:!1,type:{name:"enum",value:[{value:'"inputs"'},{value:'"outputs"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/field-add-dialog.tsx#FieldAdd"]={docgenInfo:FieldAdd.__docgenInfo,name:"FieldAdd",path:"src/components/table/field-add-dialog.tsx#FieldAdd"})}catch(__react_docgen_typescript_loader_error){}var FieldUpdate=function FieldUpdate(props){var isOpen=props.isOpen,onDismiss=props.onDismiss,onSuccess=props.onSuccess,field=props.field,_Form$useForm=es_form.Z.useForm(),form=(0,slicedToArray.Z)(_Form$useForm,1)[0];return(0,react.useEffect)((function(){isOpen&&(form.resetFields(),form.setFieldsValue({name:null==field?void 0:field.name,field:null==field?void 0:field.field}))}),[isOpen,form,field]),react.createElement(modal.Z,{title:"Update column",open:isOpen,onCancel:onDismiss,destroyOnClose:!0,okText:"Update",okButtonProps:{form:"field-update-dialog",htmlType:"submit"},width:360},react.createElement(es_form.Z,{id:"field-update-dialog",form,layout:"vertical",hideRequiredMark:!0,initialValues:{name:null==field?void 0:field.name,field:null==field?void 0:field.field},onFinish:function onFinish(data){null==onSuccess||onSuccess((0,objectSpread2.Z)((0,objectSpread2.Z)({},field),data))}},react.createElement(es_form.Z.Item,{name:"name",label:"Label",rules:[{required:!0}]},react.createElement(input.Z,null)),react.createElement(es_form.Z.Item,{name:"field",label:"Selector",rules:[{required:!0}]},react.createElement(input.Z,null))))};try{FieldUpdate.displayName="FieldUpdate",FieldUpdate.__docgenInfo={description:"",displayName:"FieldUpdate",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},field:{defaultValue:null,description:"",name:"field",required:!1,type:{name:"TableSchemaItem"}},onSuccess:{defaultValue:null,description:"",name:"onSuccess",required:!1,type:{name:"((column: TableSchemaItem) => void)"}},onDismiss:{defaultValue:null,description:"",name:"onDismiss",required:!1,type:{name:"(() => void)"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/field-update-dialog.tsx#FieldUpdate"]={docgenInfo:FieldUpdate.__docgenInfo,name:"FieldUpdate",path:"src/components/table/field-update-dialog.tsx#FieldUpdate"})}catch(__react_docgen_typescript_loader_error){}var DeploymentUnitOutlined=__webpack_require__("./node_modules/@ant-design/icons/es/icons/DeploymentUnitOutlined.js"),dnd_esm=__webpack_require__("./node_modules/@hello-pangea/dnd/dist/dnd.esm.js"),card=__webpack_require__("./node_modules/antd/es/card/index.js"),typography=__webpack_require__("./node_modules/antd/es/typography/index.js"),clsx_m=__webpack_require__("./node_modules/clsx/dist/clsx.m.js"),_excluded=["horizontal","reversed","verticalAlign","horizontalAlign","gap","height","width","grow","style"],Stack=function Stack(props){var horizontal=props.horizontal,reversed=props.reversed,_props$verticalAlign=props.verticalAlign,verticalAlign=void 0===_props$verticalAlign?"start":_props$verticalAlign,_props$horizontalAlig=props.horizontalAlign,horizontalAlign=void 0===_props$horizontalAlig?"start":_props$horizontalAlig,_props$gap=props.gap,gap=void 0===_props$gap?8:_props$gap,_props$height=props.height,height=void 0===_props$height?"auto":_props$height,_props$width=props.width,width=void 0===_props$width?"100%":_props$width,grow=props.grow,style=props.style,rest=(0,objectWithoutProperties.Z)(props,_excluded),flexDirection=(0,react.useMemo)((function(){return horizontal?reversed?"row-reverse":"row":reversed?"column-reverse":"column"}),[horizontal,reversed]);return react.createElement("div",Object.assign({style:(0,objectSpread2.Z)({display:"flex",flexDirection,justifyContent:horizontal?horizontalAlign:verticalAlign,alignItems:horizontal?verticalAlign:horizontalAlign,height,width,gap,flexGrow:grow?1:void 0},style)},rest))};try{Stack.displayName="Stack",Stack.__docgenInfo={description:"",displayName:"Stack",props:{horizontal:{defaultValue:null,description:"",name:"horizontal",required:!1,type:{name:"boolean"}},reversed:{defaultValue:null,description:"",name:"reversed",required:!1,type:{name:"boolean"}},grow:{defaultValue:null,description:"",name:"grow",required:!1,type:{name:"boolean"}},verticalAlign:{defaultValue:null,description:"",name:"verticalAlign",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'},{value:'"center"'},{value:'"space-between"'},{value:'"space-around"'},{value:'"space-evenly"'},{value:'"baseline"'},{value:'"stretch"'}]}},horizontalAlign:{defaultValue:null,description:"",name:"horizontalAlign",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'},{value:'"center"'},{value:'"space-between"'},{value:'"space-around"'},{value:'"space-evenly"'},{value:'"baseline"'},{value:'"stretch"'}]}},gap:{defaultValue:null,description:"",name:"gap",required:!1,type:{name:"string | number"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"string | number"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string | number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/stack.tsx#Stack"]={docgenInfo:Stack.__docgenInfo,name:"Stack",path:"src/components/stack.tsx#Stack"})}catch(__react_docgen_typescript_loader_error){}var strict_mode_droppable_excluded=["children"],StrictModeDroppable=function StrictModeDroppable(_ref){var children=_ref.children,props=(0,objectWithoutProperties.Z)(_ref,strict_mode_droppable_excluded),_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.Z)(_useState,2),enabled=_useState2[0],setEnabled=_useState2[1];return(0,react.useEffect)((function(){var animation=requestAnimationFrame((function(){return setEnabled(!0)}));return function(){cancelAnimationFrame(animation),setEnabled(!1)}}),[]),enabled?React.createElement(dnd_esm.bK,props,children):null};try{StrictModeDroppable.displayName="StrictModeDroppable",StrictModeDroppable.__docgenInfo={description:"",displayName:"StrictModeDroppable",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/strict-mode-droppable.tsx#StrictModeDroppable"]={docgenInfo:StrictModeDroppable.__docgenInfo,name:"StrictModeDroppable",path:"src/components/strict-mode-droppable.tsx#StrictModeDroppable"})}catch(__react_docgen_typescript_loader_error){}var FieldsReorder=function FieldsReorder(props){var isOpen=props.isOpen,onDismiss=props.onDismiss,onSuccess=props.onSuccess,fields=props.fields,_useState=(0,react.useState)([]),_useState2=(0,slicedToArray.Z)(_useState,2),columns=_useState2[0],setColumns=_useState2[1];return(0,react.useEffect)((function(){isOpen&&setColumns((0,toConsumableArray.Z)(fields||[]))}),[isOpen,fields]),react.createElement(modal.Z,{title:"Reorder fields",open:isOpen,onCancel:onDismiss,width:360,destroyOnClose:!0,bodyStyle:{paddingTop:17},okText:"Update",okButtonProps:{htmlType:"submit",form:"fields-reorder-dialog"}},react.createElement(es_form.Z,{id:"fields-reorder-dialog",onFinish:function onFinish(){null==onSuccess||onSuccess(columns)}},react.createElement(dnd_esm.Z5,{onDragEnd:function onDragEnd(result){if(result.destination){var tmpList=(0,toConsumableArray.Z)(columns),element=tmpList.splice(result.source.index,1)[0];tmpList.splice(result.destination.index,0,element),setColumns(tmpList)}}},react.createElement(StrictModeDroppable,{droppableId:"columns"},(function(provided){return react.createElement("div",Object.assign({},provided.droppableProps,{ref:provided.innerRef}),react.createElement(Stack,{gap:8,horizontalAlign:"stretch"},columns.map((function(column,index){return react.createElement(dnd_esm._l,{key:column.id,draggableId:column.id,index},(function(provided,snapshot){return react.createElement(card.Z,Object.assign({ref:provided.innerRef},provided.draggableProps,{style:provided.draggableProps.style,bodyStyle:{padding:"0.5rem"},className:(0,clsx_m.default)(snapshot.isDragging&&"grl-table__fields-reorder__card--dragging")}),react.createElement("div",{className:"grl-table__fields-reorder__item"},react.createElement(Stack,{horizontal:!0,verticalAlign:"center"},react.createElement("div",Object.assign({className:"grl-table__fields-reorder__handle"},provided.dragHandleProps),react.createElement(DeploymentUnitOutlined.Z,null)),react.createElement(Stack,{grow:!0,gap:0},react.createElement(typography.Z.Text,null,null==column?void 0:column.name),react.createElement(typography.Z.Text,{type:"secondary",style:{fontSize:12}},null==column?void 0:column.field)))))}))})),provided.placeholder))})))))};try{FieldsReorder.displayName="FieldsReorder",FieldsReorder.__docgenInfo={description:"",displayName:"FieldsReorder",props:{fields:{defaultValue:null,description:"",name:"fields",required:!1,type:{name:"TableSchemaItem[]"}},onSuccess:{defaultValue:null,description:"",name:"onSuccess",required:!1,type:{name:"((columns: TableSchemaItem[]) => void)"}},onDismiss:{defaultValue:null,description:"",name:"onDismiss",required:!1,type:{name:"(() => void)"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/fields-reorder-dialog.tsx#FieldsReorder"]={docgenInfo:FieldsReorder.__docgenInfo,name:"FieldsReorder",path:"src/components/table/fields-reorder-dialog.tsx#FieldsReorder"})}catch(__react_docgen_typescript_loader_error){}var TableDialogs=function TableDialogs(){var _useTable=useTable(),id=_useTable.id,addColumn=_useTable.addColumn,updateColumn=_useTable.updateColumn,reorderColumns=_useTable.reorderColumns,value=_useTable.value,_useTableDialog=useTableDialog(),dialog=_useTableDialog.dialog,setDialog=_useTableDialog.setDialog,isDialogActive=_useTableDialog.isDialogActive;return react.createElement(react.Fragment,null,react.createElement(FieldAdd,{id,columnType:null==dialog?void 0:dialog.columnType,isOpen:isDialogActive("add"),onSuccess:function onSuccess(data){dialog&&(addColumn(dialog.columnType,data),setDialog(void 0))},onDismiss:function onDismiss(){setDialog(void 0)}}),react.createElement(FieldUpdate,{id,isOpen:isDialogActive("edit"),onSuccess:function onSuccess(data){dialog&&(updateColumn(dialog.columnType,data.id,data),setDialog(void 0))},field:null==dialog?void 0:dialog.item,onDismiss:function onDismiss(){setDialog(void 0)}}),react.createElement(FieldsReorder,{isOpen:isDialogActive("reorder"),onSuccess:function onSuccess(data){dialog&&(reorderColumns(dialog.columnType,data),setDialog(void 0))},fields:null==value?void 0:value[null==dialog?void 0:dialog.columnType],onDismiss:function onDismiss(){setDialog(void 0)}}))};try{TableDialogs.displayName="TableDialogs",TableDialogs.__docgenInfo={description:"",displayName:"TableDialogs",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-dialogs.tsx#TableDialogs"]={docgenInfo:TableDialogs.__docgenInfo,name:"TableDialogs",path:"src/components/table/table-dialogs.tsx#TableDialogs"})}catch(__react_docgen_typescript_loader_error){}var injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),table=__webpack_require__("./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/components/table/table.scss"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(table.Z,options);table.Z&&table.Z.locals&&table.Z.locals;__webpack_require__("./node_modules/react-virtualized/styles.css"),__webpack_require__("./node_modules/antd/dist/reset.css");var es=__webpack_require__("./node_modules/react-virtualized/dist/es/index.js"),composeRefs=__webpack_require__("./node_modules/@seznam/compose-react-refs/composeRefs.js"),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),PlusOutlined=__webpack_require__("./node_modules/@ant-design/icons/es/icons/PlusOutlined.js"),table_body_cell_excluded=["className","children","selected","editing","onChange","as","minWidth","maxWidth"],BodyCell=(0,react.forwardRef)((function(props,ref){var className=props.className,children=props.children,selected=props.selected,editing=props.editing,onChange=props.onChange,_props$as=props.as,Td=void 0===_props$as?"td":_props$as,minWidth=props.minWidth,maxWidth=props.maxWidth,rest=(0,objectWithoutProperties.Z)(props,table_body_cell_excluded),cell=(0,react.useRef)(null);return(0,react.useImperativeHandle)(ref,(function(){return cell.current})),react.createElement(Td,Object.assign({ref:cell,style:{minWidth,maxWidth},className:(0,clsx_m.default)("grl-table__body__cell",className,selected&&"selected",editing&&"editing")},rest),editing?react.createElement("input",{className:"input",autoFocus:!0,tabIndex:0,type:"text",value:children,onChange}):children)})),TableBodyCell=react.memo(BodyCell);try{TableBodyCell.displayName="TableBodyCell",TableBodyCell.__docgenInfo={description:"",displayName:"TableBodyCell",props:{as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"enum",value:[{value:'"td"'},{value:'"th"'},{value:'"div"'}]}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"number"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number"}},editing:{defaultValue:null,description:"",name:"editing",required:!1,type:{name:"boolean"}},selected:{defaultValue:null,description:"",name:"selected",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"ChangeEventHandler<HTMLInputElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-body-cell.tsx#TableBodyCell"]={docgenInfo:TableBodyCell.__docgenInfo,name:"TableBodyCell",path:"src/components/table/table-body-cell.tsx#TableBodyCell"})}catch(__react_docgen_typescript_loader_error){}var table_body_row_excluded=["columnWidth","onRowAdd","dragHandleProps","index","className"],TableBodyRow=(0,react.forwardRef)((function(props,ref){var _value$rules,_useTable=useTable(),cursor=_useTable.cursor,inputs=_useTable.inputs,outputs=_useTable.outputs,editing=_useTable.editing,value=_useTable.value,inputValue=_useTable.inputValue,setInputValue=_useTable.setInputValue,cells=_useTable.cells,disabled=_useTable.disabled,columnWidth=props.columnWidth,onRowAdd=props.onRowAdd,dragHandleProps=props.dragHandleProps,y=props.index,className=props.className,rest=(0,objectWithoutProperties.Z)(props,table_body_row_excluded),firstWidth=columnWidth({index:0}),isLastRow=(null==value||null===(_value$rules=value.rules)||void 0===_value$rules?void 0:_value$rules.length)===y;return react.createElement("div",Object.assign({ref,className:(0,clsx_m.default)("grl-table__body__row",className)},rest),react.createElement(TableBodyCell,Object.assign({as:"div",className:(0,clsx_m.default)("cell",y===(null==cursor?void 0:cursor.y)&&"cursor",isLastRow&&"button","index"),minWidth:firstWidth,width:firstWidth},dragHandleProps||{},{tabIndex:void 0}),isLastRow?react.createElement(es_button.ZP,{type:"link",className:"add-row-above",disabled,onClick:function onClick(){return onRowAdd(y)}},react.createElement(PlusOutlined.Z,{style:{fontSize:16}})):y+1),[].concat((0,toConsumableArray.Z)(inputs),(0,toConsumableArray.Z)(outputs)).map((function(schema,x){var _value$rules2,_value$rules2$y,columnId=schema.id,selected=(null==cursor?void 0:cursor.x)===x&&cursor.y===y,innerValue=selected&&editing&&"content"!==schema.type&&"form"!==schema.type?inputValue:(null==value||null===(_value$rules2=value.rules)||void 0===_value$rules2||null===(_value$rules2$y=_value$rules2[y])||void 0===_value$rules2$y?void 0:_value$rules2$y[columnId])||"",width=columnWidth({index:x+1});return react.createElement(TableBodyCell,{as:"div",className:(0,clsx_m.default)("cell",isLastRow&&"noAction"),ref:function ref(instance){return cells.current["".concat(y,":").concat(columnId)]=instance},key:x,selected,editing:selected&&editing,onChange:function onChange(e){return setInputValue(e.target.value)},"data-table-cell":"","data-x":x,"data-y":y,width,minWidth:width,maxWidth:width},isLastRow?"":innerValue)})))}));try{TableBodyRow.displayName="TableBodyRow",TableBodyRow.__docgenInfo={description:"",displayName:"TableBodyRow",props:{columnWidth:{defaultValue:null,description:"",name:"columnWidth",required:!0,type:{name:"(params: Index) => number"}},onRowAdd:{defaultValue:null,description:"",name:"onRowAdd",required:!0,type:{name:"(y: number) => void"}},dragHandleProps:{defaultValue:null,description:"",name:"dragHandleProps",required:!1,type:{name:"DraggableProvidedDragHandleProps"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-body-row.tsx#TableBodyRow"]={docgenInfo:TableBodyRow.__docgenInfo,name:"TableBodyRow",path:"src/components/table/table-body-row.tsx#TableBodyRow"})}catch(__react_docgen_typescript_loader_error){}var TableBody=(0,react.forwardRef)((function(props,ref){var list=(0,react.useRef)(null),_useTable=useTable(),activeRules=_useTable.activeRules,value=_useTable.value,cursor=_useTable.cursor,setInputValue=_useTable.setInputValue,getCell=_useTable.getCell,addRowAbove=_useTable.addRowAbove,setCursor=_useTable.setCursor,disabled=_useTable.disabled,columnWidth=props.columnWidth,onScroll=props.onScroll,height=props.height,width=props.width,onRowAdd=function onRowAdd(y){disabled||(null==setCursor||setCursor(null),setInputValue(""),null==addRowAbove||addRowAbove(y))};return(0,react.useEffect)((function(){if(list.current){var scrollingContainer=react_dom.findDOMNode(list.current);if(scrollingContainer instanceof HTMLElement){var innerContainer=scrollingContainer.firstChild;if(innerContainer){var listener=function listener(){return null==onScroll?void 0:onScroll(innerContainer)};return innerContainer.addEventListener("scroll",listener),function(){innerContainer.removeEventListener("scroll",listener)}}}}}),[onScroll,list]),(0,react.useEffect)((function(){if(list.current&&cursor){var cell=getCell(cursor);if(cell){var scrollingContainer=react_dom.findDOMNode(list.current);if(scrollingContainer instanceof HTMLElement){var innerContainer=scrollingContainer.firstChild,containerScroll=innerContainer.scrollLeft,containerWidth=width,cellOffset=cell.offsetLeft,cellWidth=cell.clientWidth;0===cursor.x?innerContainer.scrollLeft=0:cellOffset<containerScroll?innerContainer.scrollLeft=cellOffset:cellOffset>=containerScroll&&cellOffset+cellWidth>containerScroll+containerWidth&&cellOffset>cell.offsetLeft-width+cell.clientWidth&&(innerContainer.scrollLeft=cell.offsetLeft-width+cell.clientWidth),list.current.scrollToRow(cursor.y)}}}}),[cursor,getCell,width]),react.createElement(react.Fragment,null,react.createElement("div",{className:"grl-table__body"},react.createElement(StrictModeDroppable,{droppableId:"droppableList",mode:"virtual",isDropDisabled:disabled,renderClone:function renderClone(provided,snapshot,rubric){return react.createElement(TableBodyRow,Object.assign({className:"dragging",onRowAdd,ref:provided.innerRef,columnWidth,index:rubric.source.index,dragHandleProps:provided.dragHandleProps},provided.draggableProps,{style:(0,objectSpread2.Z)((0,objectSpread2.Z)({},provided.draggableProps.style),{},{zIndex:99999999,fontWeight:300})}))}},(function(provided){var _value$rules;return react.createElement(es.aV,{rowCount:((null==value||null===(_value$rules=value.rules)||void 0===_value$rules?void 0:_value$rules.length)||0)+1,rowHeight:36,width,height,scrollToColumn:((null==cursor?void 0:cursor.x)||0)+1===1?0:((null==cursor?void 0:cursor.x)||0)+1,scrollToRow:null==cursor?void 0:cursor.y,className:"list",tabIndex:null,ref:(0,composeRefs.Z)(ref,list,(function(ref){if(ref){var domNode=react_dom.findDOMNode(ref);domNode instanceof HTMLElement&&provided.innerRef(domNode)}})),rowRenderer:function rowRenderer(_ref){var _value$rules2,key=_ref.key,style=_ref.style,index=_ref.index;return react.createElement(dnd_esm._l,{key,draggableId:key,index,isDragDisabled:disabled||index===(null==value||null===(_value$rules2=value.rules)||void 0===_value$rules2?void 0:_value$rules2.length)},(function(provided){var _value$rules3,_value$rules3$index;return react.createElement(TableBodyRow,Object.assign({className:null!=activeRules&&activeRules.includes(null==value||null===(_value$rules3=value.rules)||void 0===_value$rules3||null===(_value$rules3$index=_value$rules3[index])||void 0===_value$rules3$index?void 0:_value$rules3$index._id)?"active":"",onRowAdd,ref:provided.innerRef,columnWidth,index,dragHandleProps:provided.dragHandleProps},provided.draggableProps,{style:(0,objectSpread2.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},style),provided.draggableProps.style),{},{zIndex:999999})}))}))}})}))))}));try{TableBody.displayName="TableBody",TableBody.__docgenInfo={description:"",displayName:"TableBody",props:{onScroll:{defaultValue:null,description:"",name:"onScroll",required:!0,type:{name:"((params: ScrollParams) => any) | undefined"}},width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},columnWidth:{defaultValue:null,description:"",name:"columnWidth",required:!0,type:{name:"(params: Index) => number"}},preferences:{defaultValue:null,description:"",name:"preferences",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-body.tsx#TableBody"]={docgenInfo:TableBody.__docgenInfo,name:"TableBody",path:"src/components/table/table-body.tsx#TableBody"})}catch(__react_docgen_typescript_loader_error){}var dropdown=__webpack_require__("./node_modules/antd/es/dropdown/index.js"),menu=__webpack_require__("./node_modules/antd/es/menu/index.js"),isMac=navigator.platform.includes("Mac"),keyMaps={Ctrl:"⌘",Backspace:"⌫"},platform_shortcut=function shortcut(s){return isMac?Object.keys(keyMaps).reduce((function(acc,key){return acc.replaceAll(key,keyMaps[key])}),s):s},unsecuredCopyToClipboard=function unsecuredCopyToClipboard(text){console.log("Insecure copy to clipboard:",text);var textArea=document.createElement("textarea");textArea.value=text,document.body.appendChild(textArea),textArea.focus(),textArea.select();try{document.execCommand("copy")}catch(err){console.error("Unable to copy to clipboard",err)}document.body.removeChild(textArea)},copyToClipboard=function(){var _ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(content){return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!window.isSecureContext||!navigator.clipboard){_context.next=5;break}return _context.next=3,navigator.clipboard.writeText(content);case 3:_context.next=6;break;case 5:unsecuredCopyToClipboard(content);case 6:case"end":return _context.stop()}}),_callee)})));return function copyToClipboard(_x){return _ref.apply(this,arguments)}}(),pasteFromClipboard=function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(){return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.abrupt("return",navigator.clipboard.readText());case 4:return _context2.prev=4,_context2.t0=_context2.catch(0),_context2.abrupt("return","");case 7:case"end":return _context2.stop()}}),_callee2,null,[[0,4]])})));return function pasteFromClipboard(){return _ref2.apply(this,arguments)}}(),SpacedText=function SpacedText(_ref){var left=_ref.left,right=_ref.right,_ref$gap=_ref.gap,gap=void 0===_ref$gap?16:_ref$gap;return react.createElement(Stack,{gap,horizontal:!0,horizontalAlign:"space-between"},react.createElement(typography.Z.Text,{style:{color:"inherit"}},left),react.createElement(typography.Z.Text,{style:{color:"inherit"}},right))};try{SpacedText.displayName="SpacedText",SpacedText.__docgenInfo={description:"",displayName:"SpacedText",props:{left:{defaultValue:null,description:"",name:"left",required:!0,type:{name:"string"}},right:{defaultValue:null,description:"",name:"right",required:!0,type:{name:"string"}},gap:{defaultValue:{value:"16"},description:"",name:"gap",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/spaced-text.tsx#SpacedText"]={docgenInfo:SpacedText.__docgenInfo,name:"SpacedText",path:"src/components/spaced-text.tsx#SpacedText"})}catch(__react_docgen_typescript_loader_error){}var ContextMenu=function ContextMenu(props){var _onClick2,_onClick,children=props.children,_useTable=useTable(),cursor=_useTable.cursor,addRowBelow=_useTable.addRowBelow,addRowAbove=_useTable.addRowAbove,removeRow=_useTable.removeRow,getColumnId=_useTable.getColumnId,value=_useTable.value,commitData=_useTable.commitData;return react.createElement(dropdown.Z,{destroyPopupOnHide:!0,transitionName:"",overlayStyle:{minWidth:270},overlay:react.createElement(menu.Z,{items:[{key:"addRowAbove",label:react.createElement(SpacedText,{left:"Add row above",right:platform_shortcut("Ctrl + Up")}),onClick:function onClick(){cursor&&addRowAbove(cursor.y)}},{key:"addRowBelow",label:react.createElement(SpacedText,{left:"Add row below",right:platform_shortcut("Ctrl + Down")}),onClick:function onClick(){cursor&&addRowBelow(cursor.y)}},{type:"divider"},{key:"remove",label:react.createElement(SpacedText,{left:"Remove row",right:platform_shortcut("Ctrl + Backspace")}),onClick:function onClick(){cursor&&removeRow(cursor.y)}},{type:"divider"},{key:"copy",label:react.createElement(SpacedText,{left:"Copy",right:platform_shortcut("Ctrl + C")}),onClick:(_onClick=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){var _value$rules,_value$rules$cursor$y,columnId;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(cursor){_context.next=2;break}return _context.abrupt("return");case 2:if(columnId=getColumnId(cursor.x)){_context.next=5;break}return _context.abrupt("return");case 5:return _context.next=7,copyToClipboard((null===(_value$rules=value.rules)||void 0===_value$rules||null===(_value$rules$cursor$y=_value$rules[cursor.y])||void 0===_value$rules$cursor$y?void 0:_value$rules$cursor$y[columnId])||"");case 7:case"end":return _context.stop()}}),_callee)}))),function onClick(){return _onClick.apply(this,arguments)})},{key:"paste",label:react.createElement(SpacedText,{left:"Paste",right:platform_shortcut("Ctrl + V")}),onClick:(_onClick2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(){var value;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(cursor){_context2.next=2;break}return _context2.abrupt("return");case 2:return _context2.next=4,pasteFromClipboard();case 4:value=_context2.sent,commitData(value,cursor);case 6:case"end":return _context2.stop()}}),_callee2)}))),function onClick(){return _onClick2.apply(this,arguments)})}]}),trigger:["contextMenu"]},children)},TableContextMenu=react.memo(ContextMenu);try{TableContextMenu.displayName="TableContextMenu",TableContextMenu.__docgenInfo={description:"",displayName:"TableContextMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-context-menu.tsx#TableContextMenu"]={docgenInfo:TableContextMenu.__docgenInfo,name:"TableContextMenu",path:"src/components/table/table-context-menu.tsx#TableContextMenu"})}catch(__react_docgen_typescript_loader_error){}var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),DownOutlined=__webpack_require__("./node_modules/@ant-design/icons/es/icons/DownOutlined.js"),cjs=__webpack_require__("./node_modules/react-draggable/build/cjs/cjs.js"),cjs_default=__webpack_require__.n(cjs),table_head_cell_excluded=["className","children","resizable","as","onWidthChange"],TableHeadCell=(0,react.forwardRef)((function(props,ref){var className=props.className,children=props.children,resizable=props.resizable,_props$as=props.as,Td=void 0===_props$as?"td":_props$as,onWidthChange=props.onWidthChange,rest=(0,objectWithoutProperties.Z)(props,table_head_cell_excluded),cell=(0,react.useRef)(null);return(0,react.useImperativeHandle)(ref,(function(){return cell.current})),react.createElement(Td,Object.assign({ref:cell,className:(0,clsx_m.default)("grl-table__head__cell",className)},rest),children,resizable&&react.createElement(react.Fragment,null,react.createElement(cjs_default(),{axis:"x",position:{x:0,y:0},onDrag:function onDrag(e,data){cell.current&&(null==onWidthChange||onWidthChange(data.deltaX))}},react.createElement("div",{className:"resizer"}))))}));try{TableHeadCell.displayName="TableHeadCell",TableHeadCell.__docgenInfo={description:"",displayName:"TableHeadCell",props:{resizable:{defaultValue:null,description:"",name:"resizable",required:!1,type:{name:"boolean"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"enum",value:[{value:'"td"'},{value:'"th"'},{value:'"div"'}]}},onWidthChange:{defaultValue:null,description:"",name:"onWidthChange",required:!1,type:{name:"((width?: number) => void)"}},field:{defaultValue:null,description:"",name:"field",required:!1,type:{name:"TableSchemaItem"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-head-cell.tsx#TableHeadCell"]={docgenInfo:TableHeadCell.__docgenInfo,name:"TableHeadCell",path:"src/components/table/table-head-cell.tsx#TableHeadCell"})}catch(__react_docgen_typescript_loader_error){}var TableHead=(0,react.forwardRef)((function(props,ref){var topRef=(0,react.useRef)(null),bottomRef=(0,react.useRef)(null),_useTable=useTable(),value=_useTable.value,inputs=_useTable.inputs,outputs=_useTable.outputs,configurable=_useTable.configurable,disabled=_useTable.disabled,removeColumn=_useTable.removeColumn,setDialog=useTableDialog().setDialog,preferences=props.preferences,onPreferencesChange=props.onPreferencesChange,width=props.width,height=props.height,height2=props.height2,scrollLeft=props.scrollLeft,scrollTop=props.scrollTop,_columnWidth=props.columnWidth;return(0,react.useImperativeHandle)(ref,(function(){return{recomputeGridSize:function recomputeGridSize(){var _topRef$current,_bottomRef$current;null===(_topRef$current=topRef.current)||void 0===_topRef$current||_topRef$current.recomputeGridSize(),null===(_bottomRef$current=bottomRef.current)||void 0===_bottomRef$current||_bottomRef$current.recomputeGridSize()}}})),react.createElement("div",null,react.createElement(es.rj,{ref:topRef,className:"grl-table__head",style:{overflow:"hidden !important"},tabIndex:null,cellRenderer:function cellRenderer(cellProps){var _value$inputs,_value$outputs,x=cellProps.columnIndex,style=cellProps.style,key=cellProps.key;switch(x){case 0:return react.createElement(TableHeadCell,{key,style,as:"div",className:"cell"},react.createElement("div",null,"ID"));case 1:return react.createElement(TableHeadCell,{key,style,as:"div",className:"cell"},react.createElement("div",null,react.createElement("div",null,"Inputs")),react.createElement("div",{style:{marginLeft:"auto"}},configurable&&!disabled&&react.createElement(space.Z,null,(null==value||null===(_value$inputs=value.inputs)||void 0===_value$inputs?void 0:_value$inputs.length)>1&&react.createElement(es_button.ZP,{type:"link",onClick:function onClick(){setDialog({type:"reorder",columnType:"inputs",item:null})}},"Reorder"),react.createElement(es_button.ZP,{type:"link",onClick:function onClick(){setDialog({type:"add",columnType:"inputs",item:null})}},"Add"))));case 2:return react.createElement(TableHeadCell,{key,style,as:"div",className:"cell"},react.createElement("div",null,"Outputs"),react.createElement("div",{style:{marginLeft:"auto"}},configurable&&!disabled&&react.createElement(space.Z,null,(null==value||null===(_value$outputs=value.outputs)||void 0===_value$outputs?void 0:_value$outputs.length)>1&&react.createElement(es_button.ZP,{type:"link",onClick:function onClick(){setDialog({type:"reorder",columnType:"outputs",item:null})}},"Reorder"),react.createElement(es_button.ZP,{type:"link",onClick:function onClick(){setDialog({type:"add",columnType:"outputs",item:null})}},"Add"))));default:return react.createElement(TableHeadCell,{key,style,as:"div",className:"cell"},react.createElement("div",null,"Description"))}},rowCount:1,rowHeight:height2,width,height:height2,columnCount:4,columnWidth:function columnWidth(_ref){var index=_ref.index,inputsWidth=inputs.reduce((function(acc,_,i){return acc+_columnWidth({index:i+1})}),0),outputsWidth=outputs.reduce((function(acc,_,i){return acc+_columnWidth({index:i+inputs.length+1})}),0);switch(index){case 0:return _columnWidth({index:0});case 1:return inputsWidth<200?200:inputsWidth;case 2:return outputsWidth<200?200:outputsWidth;default:return 0}},scrollTop,scrollLeft}),react.createElement(es.rj,{ref:bottomRef,className:"grl-table__head",style:{overflow:"hidden !important"},tabIndex:null,cellRenderer:function cellRenderer(cellProps){var _ref2,x=cellProps.columnIndex,style=cellProps.style,key=cellProps.key;if(0===x)return react.createElement(TableHeadCell,{as:"div",key,className:"cell",style});var column=null===(_ref2=[].concat((0,toConsumableArray.Z)(inputs),(0,toConsumableArray.Z)(outputs)))||void 0===_ref2?void 0:_ref2[x-1],columnType=value.inputs.includes(column)?"inputs":"outputs";return react.createElement(TableHeadCell,{key,style,as:"div",resizable:!0,className:(0,clsx_m.default)("cell",value.inputs.includes(column)&&"input",value.outputs.includes(column)&&"output"),onWidthChange:function onWidthChange(width){var _preferences$current,_preferences$current2,_preferences$current3;preferences.current=(0,objectSpread2.Z)((0,objectSpread2.Z)({},preferences.current||{}),{},{size:(0,objectSpread2.Z)((0,objectSpread2.Z)({},(null===(_preferences$current=preferences.current)||void 0===_preferences$current?void 0:_preferences$current.size)||{}),{},(0,defineProperty.Z)({},column.id,Math.max(((null===(_preferences$current2=preferences.current)||void 0===_preferences$current2||null===(_preferences$current3=_preferences$current2.size)||void 0===_preferences$current3?void 0:_preferences$current3[column.id])||200)+width,200)))}),null==onPreferencesChange||onPreferencesChange()}},null!=column&&column.field?react.createElement(Stack,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},react.createElement("div",null,react.createElement(typography.Z.Text,{style:{display:"block"}},null==column?void 0:column.name),react.createElement(typography.Z.Text,{type:"secondary",style:{fontSize:12,fontWeight:300}},null==column?void 0:column.field)),configurable&&!disabled&&react.createElement(dropdown.Z,{trigger:["click"],overlayStyle:{minWidth:140},overlay:react.createElement(menu.Z,{items:[{key:"edit",label:"Edit column",onClick:function onClick(){setDialog({type:"edit",columnType,item:column})}},{key:"remove",label:"Remove column",onClick:function onClick(){modal.Z.confirm({title:"Remove column",content:react.createElement(typography.Z.Paragraph,null,"You are about to delete"," ",react.createElement("strong",null,column.name)," column."),icon:!1,okText:"Remove",okButtonProps:{danger:!0},onOk:function onOk(){removeColumn(columnType,column.id)}})}}]})},react.createElement(es_button.ZP,{type:"link",style:{height:"auto",lineHeight:"1em",padding:"0.5rem 0.25rem"}},react.createElement(DownOutlined.Z,{style:{fontSize:16}})))):react.createElement(typography.Z.Text,null,null==column?void 0:column.name))},rowCount:1,rowHeight:height,width,height,columnCount:1+((null==inputs?void 0:inputs.length)>0?null==inputs?void 0:inputs.length:1)+((null==outputs?void 0:outputs.length)>0?null==outputs?void 0:outputs.length:1),columnWidth:_columnWidth,scrollTop,scrollLeft}))}));try{TableHead.displayName="TableHead",TableHead.__docgenInfo={description:"",displayName:"TableHead",props:{preferences:{defaultValue:null,description:"",name:"preferences",required:!0,type:{name:"any"}},width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},height2:{defaultValue:null,description:"",name:"height2",required:!0,type:{name:"number"}},scrollTop:{defaultValue:null,description:"",name:"scrollTop",required:!0,type:{name:"number"}},scrollLeft:{defaultValue:null,description:"",name:"scrollLeft",required:!0,type:{name:"number"}},onScroll:{defaultValue:null,description:"",name:"onScroll",required:!0,type:{name:"((params: ScrollParams) => any) | undefined"}},onPreferencesChange:{defaultValue:null,description:"",name:"onPreferencesChange",required:!1,type:{name:"(() => void)"}},columnWidth:{defaultValue:null,description:"",name:"columnWidth",required:!0,type:{name:"(params: Index) => number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table-head.tsx#TableHead"]={docgenInfo:TableHead.__docgenInfo,name:"TableHead",path:"src/components/table/table-head.tsx#TableHead"})}catch(__react_docgen_typescript_loader_error){}const table_main=function TableMain(){var _useTable=useTable(),namespace=_useTable.namespace,table=_useTable.table,swapRows=_useTable.swapRows,value=_useTable.value,inputs=_useTable.inputs,outputs=_useTable.outputs,preferences=(0,react.useRef)(function loadTablePreferences(namespace){try{var stringData=localStorage.getItem("decisionTable.preferences.".concat(namespace));return stringData?JSON.parse(stringData):{}}catch(e){return{}}}(namespace)),headerRef=(0,react.useRef)(null),bodyRef=(0,react.useRef)(null),schemaHash=[].concat((0,toConsumableArray.Z)(inputs),(0,toConsumableArray.Z)(outputs)).map((function(i){return i.id})).join("::"),recomputeSizes=function recomputeSizes(){var _headerRef$current,_bodyRef$current;null===(_headerRef$current=headerRef.current)||void 0===_headerRef$current||_headerRef$current.recomputeGridSize(),null===(_bodyRef$current=bodyRef.current)||void 0===_bodyRef$current||_bodyRef$current.recomputeGridSize(),function saveTablePreferences(namespace,preferences){try{var stringData=JSON.stringify(preferences);if(!stringData)return;localStorage.setItem("decisionTable.preferences.".concat(namespace),stringData)}catch(e){return}}(namespace,preferences.current)};(0,react.useEffect)((function(){recomputeSizes()}),[recomputeSizes,schemaHash]);var columnWidth=function columnWidth(_ref){var _ref2,_preferences$current,_preferences$current$,index=_ref.index;if(0===index)return 50;var schema=null===(_ref2=[].concat((0,toConsumableArray.Z)(inputs),(0,toConsumableArray.Z)(outputs)))||void 0===_ref2?void 0:_ref2[index-1];return(null===(_preferences$current=preferences.current)||void 0===_preferences$current||null===(_preferences$current$=_preferences$current.size)||void 0===_preferences$current$?void 0:_preferences$current$[schema.id])||200},tableEvents=function useTableEvents(){var _onKeyDownCapture,_useTable=useTable(),editing=_useTable.editing,setEditing=_useTable.setEditing,cursor=_useTable.cursor,getElementsFromEvent=_useTable.getElementsFromEvent,getCursorFromEvent=_useTable.getCursorFromEvent,getCell=_useTable.getCell,getColumnId=_useTable.getColumnId,setCursor=_useTable.setCursor,trySetCursor=_useTable.trySetCursor,inputValue=_useTable.inputValue,setInputValue=_useTable.setInputValue,commitData=_useTable.commitData,value=_useTable.value,addRowBelow=_useTable.addRowBelow,addRowAbove=_useTable.addRowAbove,removeRow=_useTable.removeRow,undo=_useTable.undo,redo=_useTable.redo,table=_useTable.table,isLastElementFromEvent=_useTable.isLastElementFromEvent,isContentElementFromEvent=_useTable.isContentElementFromEvent,disabled=_useTable.disabled;return{onContextMenuCapture:function onContextMenuCapture(e){if(!disabled){var target=e.target;if(!isLastElementFromEvent(e))if("TEXTAREA"!==target.nodeName&&"INPUT"!==target.nodeName){var elements=getElementsFromEvent(e),cursor=getCursorFromEvent(e);elements&&(e.preventDefault(),cursor&&editing&&(commitData(inputValue,cursor),setEditing(!1),setInputValue("")),setCursor(cursor))}else e.preventDefault()}},onClickCapture:function onClickCapture(e){var nextCursor=getCursorFromEvent(e);isLastElementFromEvent(e)||(null==nextCursor?void 0:nextCursor.x)===(null==cursor?void 0:cursor.x)&&(null==nextCursor?void 0:nextCursor.y)===(null==cursor?void 0:cursor.y)||nextCursor&&(cursor&&editing&&(commitData(inputValue,cursor),setEditing(!1),setInputValue("")),setCursor(nextCursor),e.preventDefault())},onDoubleClickCapture:function onDoubleClickCapture(e){var _querySelector;disabled||isLastElementFromEvent(e)||(isContentElementFromEvent(e)?null===(_querySelector=e.target.querySelector("button"))||void 0===_querySelector||_querySelector.click():cursor&&setEditing(!0))},onFocusCapture:function onFocusCapture(e){var target=e.target;if(!isLastElementFromEvent(e)&&!isContentElementFromEvent(e)&&"TEXTAREA"!==target.nodeName&&"INPUT"!==target.nodeName){var nextCursor=getCursorFromEvent(e);nextCursor&&(cursor&&editing&&(commitData(inputValue,cursor),setEditing(!1),setInputValue(""),setCursor(nextCursor)),e.preventDefault())}},onKeyDownCapture:(_onKeyDownCapture=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(e){var preventDefault,target,isInput,x,y,currentCell,_value$rules,_value$rules$y,columnId,_value,_currentCell$querySel,dy,dx;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(cursor){_context.next=2;break}return _context.abrupt("return");case 2:if(preventDefault=function preventDefault(){var _table$current;e.preventDefault(),e.stopPropagation(),null===(_table$current=table.current)||void 0===_table$current||_table$current.focus()},"Escape"!==e.code||!editing){_context.next=7;break}return setInputValue(""),setEditing(!1),_context.abrupt("return",preventDefault());case 7:if(target=e.target,isInput="TEXTAREA"===target.nodeName||"INPUT"===target.nodeName,x=cursor.x,y=cursor.y,currentCell=getCell(cursor),"KeyC"!==e.code||!e.metaKey&&!e.ctrlKey||editing){_context.next=18;break}if(columnId=getColumnId(x)){_context.next=15;break}return _context.abrupt("return",preventDefault());case 15:return _context.next=17,copyToClipboard((null===(_value$rules=value.rules)||void 0===_value$rules||null===(_value$rules$y=_value$rules[y])||void 0===_value$rules$y?void 0:_value$rules$y[columnId])||"");case 17:return _context.abrupt("return",preventDefault());case 18:if("KeyV"!==e.code||!e.metaKey&&!e.ctrlKey||disabled){_context.next=24;break}return _context.next=21,pasteFromClipboard();case 21:return _value=_context.sent,commitData(_value,cursor),_context.abrupt("return",preventDefault());case 24:if("KeyZ"!==e.code||!e.metaKey&&!e.ctrlKey||disabled){_context.next=28;break}return editing&&(setEditing(!1),setInputValue("")),e.shiftKey?redo():undo(),_context.abrupt("return",preventDefault());case 28:if("KeyY"!==e.code||!e.metaKey&&!e.ctrlKey||disabled){_context.next=32;break}return editing&&(setEditing(!1),setInputValue("")),redo(),_context.abrupt("return",preventDefault());case 32:if("Enter"!==e.code){_context.next=50;break}if(!e.metaKey&&!e.altKey){_context.next=37;break}return e.preventDefault(),e.stopPropagation(),_context.abrupt("return");case 37:if(!e.ctrlKey){_context.next=45;break}if(editing){_context.next=41;break}return"content"===(null==currentCell?void 0:currentCell.getAttribute("data-type"))&&(null===(_currentCell$querySel=currentCell.querySelector("button"))||void 0===_currentCell$querySel||_currentCell$querySel.click()),_context.abrupt("return",preventDefault());case 41:return commitData(inputValue,cursor),setEditing(!1),setInputValue(""),_context.abrupt("return",preventDefault());case 45:return dy=e.shiftKey?-1:1,editing&&(commitData(inputValue,cursor),setEditing(!1)),trySetCursor({x,y:y+dy}),setInputValue(""),_context.abrupt("return",preventDefault());case 50:if("Tab"!==e.code){_context.next=55;break}return editing&&(commitData(inputValue,cursor),setEditing(!1),setInputValue("")),dx=e.shiftKey?-1:1,trySetCursor({x:x+dx,y}),_context.abrupt("return",preventDefault());case 55:if(!isInput){_context.next=57;break}return _context.abrupt("return");case 57:if("ArrowUp"!==e.code){_context.next=63;break}if(!e.metaKey&&!e.altKey||disabled){_context.next=61;break}return addRowAbove(y),_context.abrupt("return",preventDefault());case 61:return trySetCursor({x,y:y-1}),_context.abrupt("return",preventDefault());case 63:if("ArrowDown"!==e.code){_context.next=69;break}if(!e.metaKey&&!e.altKey||disabled){_context.next=67;break}return addRowBelow(y),_context.abrupt("return",preventDefault());case 67:return trySetCursor({x,y:y+1}),_context.abrupt("return",preventDefault());case 69:if("ArrowLeft"!==e.code){_context.next=72;break}return trySetCursor({x:x-1,y}),_context.abrupt("return",preventDefault());case 72:if("ArrowRight"!==e.code){_context.next=75;break}return trySetCursor({x:x+1,y}),_context.abrupt("return",preventDefault());case 75:if("Backspace"!==e.code||editing||!currentCell||disabled){_context.next=81;break}if(!e.metaKey&&!e.altKey){_context.next=79;break}return removeRow(y),_context.abrupt("return",preventDefault());case 79:return commitData("",cursor),_context.abrupt("return",preventDefault());case 81:if(1!==e.key.length||editing||e.metaKey||e.ctrlKey||e.altKey||disabled){_context.next=85;break}return setEditing(!0),setInputValue(e.key),_context.abrupt("return",preventDefault());case 85:case"end":return _context.stop()}}),_callee)}))),function onKeyDownCapture(_x){return _onKeyDownCapture.apply(this,arguments)}),onBlurCapture:function onBlurCapture(e){var tableElement=table.current;if(tableElement){var relatedTarget=e.relatedTarget;return relatedTarget?tableElement.contains(relatedTarget)?e.preventDefault():void(editing&&cursor&&(commitData(inputValue,cursor),setEditing(!1),setInputValue(""))):function preventDefault(){e.preventDefault(),e.stopPropagation();var _currentCell$querySel2,currentCell=getCell(cursor);currentCell&&currentCell.querySelector("input")?null===(_currentCell$querySel2=currentCell.querySelector("input"))||void 0===_currentCell$querySel2||_currentCell$querySel2.focus():tableElement.focus()}()}}}}();return react.createElement(dnd_esm.Z5,{onDragEnd:function onDragEnd(result){var _result$destination,_result$destination2,_value$rules;isNaN(result.source.index)||isNaN(null===(_result$destination=result.destination)||void 0===_result$destination?void 0:_result$destination.index)||(null==result||null===(_result$destination2=result.destination)||void 0===_result$destination2?void 0:_result$destination2.index)<(null==value||null===(_value$rules=value.rules)||void 0===_value$rules?void 0:_value$rules.length)&&swapRows(result.source.index,result.destination.index)}},react.createElement("div",Object.assign({className:(0,clsx_m.default)("grl-table__main"),ref:table,tabIndex:0},tableEvents),react.createElement(es.qj,null,(function(_ref3){var width=_ref3.width,height=_ref3.height;return react.createElement(es.Ew,null,(function(_ref4){var _value$inputs,_value$outputs,scrollTop=_ref4.scrollTop,scrollLeft=_ref4.scrollLeft,onScroll=_ref4.onScroll;return react.createElement(react.Fragment,null,react.createElement(TableHead,{ref:headerRef,scrollLeft,scrollTop,onScroll,width,height:48,height2:36,columnWidth,preferences,onPreferencesChange:recomputeSizes}),(null==value||null===(_value$inputs=value.inputs)||void 0===_value$inputs?void 0:_value$inputs.length)>0&&(null==value||null===(_value$outputs=value.outputs)||void 0===_value$outputs?void 0:_value$outputs.length)>0&&react.createElement(TableContextMenu,null,react.createElement("div",null,react.createElement(TableBody,{ref:bodyRef,onScroll,width,height:height-48-36,columnWidth,preferences:preferences.current}))))}))}))))};var _Primary$parameters,_Primary$parameters2,_Primary$parameters2$,table_excluded=["name"],Table=function Table(props){var name=props.name,rest=(0,objectWithoutProperties.Z)(props,table_excluded);return react.createElement("div",{className:"grl-table"},react.createElement(table_context,Object.assign({name},rest),react.createElement(TableDialogProvider,null,react.createElement(table_command_bar,null),react.createElement(table_main,null),react.createElement(TableDialogs,null))))};try{Table.displayName="Table",Table.__docgenInfo={description:"",displayName:"Table",props:{name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"TableProps"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((decisionTable: TableProps) => void)"}},namespace:{defaultValue:null,description:"",name:"namespace",required:!1,type:{name:"string"}},activeRules:{defaultValue:null,description:"",name:"activeRules",required:!1,type:{name:"string[]"}},configurable:{defaultValue:null,description:"",name:"configurable",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/table/table.tsx#Table"]={docgenInfo:Table.__docgenInfo,name:"Table",path:"src/components/table/table.tsx#Table"})}catch(__react_docgen_typescript_loader_error){}const table_stories={title:"Table",component:Table};var Primary={render:function render(){return react.createElement("div",{style:{height:400}},react.createElement(Table,{configurable:!0,value:{hitPolicy:"first",inputs:[{id:"123",name:"Input",field:"input",type:"expression"},{id:"124",name:"Input2",field:"input2",type:"expression"}],outputs:[{id:"333",name:"Output",field:"output",type:"expression"}],rules:[{_id:"111",124:"1111",333:"Test Output",123:"Tesst Input",_description:"Some random description"},{_id:"222",124:"2222",333:"Test Output",123:"Tesst Input",_description:"Some random description"},{_id:"333",124:"3333",333:"Test Output",123:"Tesst Input",_description:"Some random description"}]}}))}};Primary.parameters=(0,objectSpread2.Z)((0,objectSpread2.Z)({},Primary.parameters),{},{docs:(0,objectSpread2.Z)((0,objectSpread2.Z)({},null===(_Primary$parameters=Primary.parameters)||void 0===_Primary$parameters?void 0:_Primary$parameters.docs),{},{source:(0,objectSpread2.Z)({originalSource:"{\n  render: () => <div style={{\n    height: 400\n  }}>\n      <Table configurable value={{\n      hitPolicy: 'first',\n      inputs: [{\n        id: '123',\n        name: 'Input',\n        field: 'input',\n        type: 'expression'\n      }, {\n        id: '124',\n        name: 'Input2',\n        field: 'input2',\n        type: 'expression'\n      }],\n      outputs: [{\n        id: '333',\n        name: 'Output',\n        field: 'output',\n        type: 'expression'\n      }],\n      rules: [{\n        '_id': '111',\n        '124': '1111',\n        '333': 'Test Output',\n        '123': 'Tesst Input',\n        '_description': 'Some random description'\n      }, {\n        '_id': '222',\n        '124': '2222',\n        '333': 'Test Output',\n        '123': 'Tesst Input',\n        '_description': 'Some random description'\n      }, {\n        '_id': '333',\n        '124': '3333',\n        '333': 'Test Output',\n        '123': 'Tesst Input',\n        '_description': 'Some random description'\n      }]\n    }} />\n    </div>\n}"},null===(_Primary$parameters2=Primary.parameters)||void 0===_Primary$parameters2||null===(_Primary$parameters2$=_Primary$parameters2.docs)||void 0===_Primary$parameters2$?void 0:_Primary$parameters2$.source)})});const __namedExportsOrder=["Primary"]},"./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/components/table/table.scss":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,".grl-table{height:100%;display:flex;flex-direction:column}.grl-table__main{position:relative;outline:none !important;width:100%;height:100%;max-height:100%;overflow:auto;line-height:1.1em}.grl-table__body .list{overflow:auto !important}.grl-table__body .list.ReactVirtualized__Grid__innerScrollContainer{overflow:auto !important;min-height:100%}.grl-table__body__row{display:flex}.grl-table__body__row.dragging>div{background:#90ee90}.grl-table__body__row.active>div{background:#add8e6}.grl-table__body__row .cell{display:flex;align-items:center;background:#ffb6c1;padding:6px 8px;box-sizing:border-box;border:.5px solid #000;white-space:nowrap;user-select:none}.grl-table__body__row .cell.cursor{background:#f08080}.grl-table__body__row .cell.index{cursor:grab !important}.grl-table__body__row .cell.button{padding:0;display:flex;justify-content:center;align-items:center;cursor:pointer !important}.grl-table__body__row .cell.noAction{cursor:not-allowed !important}.grl-table__body .add-row-above{display:flex;width:100%;height:100%;justify-content:center;align-items:center;text-decoration:none !important}.grl-table__body__cell{position:relative;overflow-x:auto}.grl-table__body__cell.selected{outline-offset:-2px;outline:2px solid blue}.grl-table__body__cell:not(.editing){cursor:cell}.grl-table__body__cell .input{position:absolute;z-index:5;top:2px;left:2px;right:2px;bottom:2px;box-sizing:border-box;border:none !important;outline:none !important;border-radius:0 !important;padding:5px 6px 6px;line-height:1}.grl-table__head{overflow:hidden !important}.grl-table__head .cell{display:flex;justify-content:flex-start;align-items:center;background:#ff0;border:.5px solid orange;font-weight:400;padding:8px;box-sizing:border-box}.grl-table__head__cell{position:relative;overflow:visible}.grl-table__head__cell .resizer{position:absolute;top:0;bottom:0;right:-8px;width:8px;background:rgba(0,0,0,0);z-index:10;cursor:col-resize}.grl-table__fields-reorder__item{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.grl-table__fields-reorder__handle{background-color:#f0f2f5;height:32px;width:32px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.grl-table__fields-reorder__card--dragging{background-color:#f0f2f5;box-shadow:var(--box-shadow-4);user-select:none}","",{version:3,sources:["webpack://./src/components/table/table.scss"],names:[],mappings:"AAAA,WACE,WAAA,CACA,YAAA,CACA,qBAAA,CAEA,iBACE,iBAAA,CACA,uBAAA,CACA,UAAA,CACA,WAAA,CACA,eAAA,CACA,aAAA,CACA,iBAAA,CAIA,uBACE,wBAAA,CACA,oEACE,wBAAA,CACA,eAAA,CAGJ,sBACE,YAAA,CAIA,mCACE,kBAAA,CAEF,iCACE,kBAAA,CAGF,4BACE,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,eAAA,CACA,qBAAA,CACA,sBAAA,CACA,kBAAA,CACA,gBAAA,CACA,mCACE,kBAAA,CAEF,kCACE,sBAAA,CAEF,mCACE,SAAA,CACA,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,yBAAA,CAEF,qCACE,6BAAA,CAKN,gCACE,YAAA,CACA,UAAA,CACA,WAAA,CACA,sBAAA,CACA,kBAAA,CACA,+BAAA,CAEF,uBACE,iBAAA,CACA,eAAA,CACA,gCACE,mBAAA,CACA,sBAAA,CAEF,qCACE,WAAA,CAGF,8BACE,iBAAA,CACA,SAAA,CACA,OAAA,CACA,QAAA,CACA,SAAA,CACA,UAAA,CACA,qBAAA,CACA,sBAAA,CACA,uBAAA,CACA,0BAAA,CACA,mBAAA,CACA,aAAA,CAKN,iBACE,0BAAA,CAEA,uBACE,YAAA,CACA,0BAAA,CACA,kBAAA,CACA,eAAA,CACA,wBAAA,CACA,eAAA,CACA,WAAA,CACA,qBAAA,CAGF,uBACE,iBAAA,CACA,gBAAA,CAEA,gCACE,iBAAA,CACA,KAAA,CACA,QAAA,CACA,UAAA,CACA,SAAA,CACA,wBAAA,CACA,UAAA,CACA,iBAAA,CAMJ,iCACE,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,6BAAA,CAGF,mCACE,wBAAA,CACA,WAAA,CACA,UAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,aAAA,CAIA,2CACE,wBAAA,CACA,8BAAA,CACA,gBAAA",sourcesContent:[".grl-table {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  &__main {\n    position: relative;\n    outline: none !important;\n    width: 100%;\n    height: 100%;\n    max-height: 100%;\n    overflow: auto;\n    line-height: 1.1em;\n  }\n\n  &__body {\n    .list {\n      overflow: auto !important;\n      &.ReactVirtualized__Grid__innerScrollContainer {\n        overflow: auto !important;\n        min-height: 100%;\n      }\n    }\n    &__row {\n      display: flex;\n      //font-family: theme.fonts.medium.fontFamily;\n      //font-size: theme.fonts.medium.fontSize,\n      //font-weight: theme.fonts.small.fontWeight,\n      &.dragging > div {\n        background: lightgreen; //'var(--decisionTable-head-background)',\n      }\n      &.active > div {\n        background: lightblue; //'var(--decisionTable-row-active)',\n      }\n\n      .cell {\n        display: flex;\n        align-items: center;\n        background: lightpink; // var(--decisionTable-background)',\n        padding: 6px 8px;\n        box-sizing: border-box;\n        border: 0.5px solid black; //var(--decisionTable-border)`,\n        white-space: nowrap;\n        user-select: none;\n        &.cursor {\n          background: lightcoral; // 'var(--decisionTable-row-cursor) !important',\n        }\n        &.index {\n          cursor: grab !important;\n        }\n        &.button {\n          padding: 0;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          cursor: pointer !important;\n        }\n        &.noAction {\n          cursor: not-allowed !important;\n        }\n      }\n    }\n\n    .add-row-above {\n      display: flex;\n      width: 100%;\n      height: 100%;\n      justify-content: center;\n      align-items: center;\n      text-decoration: none !important;\n    }\n    &__cell {\n      position: relative;\n      overflow-x: auto;\n      &.selected {\n        outline-offset: -2px;\n        outline: 2px solid blue; // var(--decisionTable-primary)`,\n      }\n      &:not(.editing) {\n        cursor: cell;\n      }\n\n      .input {\n        position: absolute;\n        z-index: 5;\n        top: 2px;\n        left: 2px;\n        right: 2px;\n        bottom: 2px;\n        box-sizing: border-box;\n        border: none !important;\n        outline: none !important;\n        border-radius: 0 !important;\n        padding: 5px 6px 6px;\n        line-height: 1;\n      }\n    }\n  }\n\n  &__head {\n    overflow: hidden !important;\n\n    .cell {\n      display: flex;\n      justify-content: flex-start;\n      align-items: center;\n      background: yellow; //'var(--decisionTable-head-background)',\n      border: 0.5px solid orange; //var(--decisionTable-border)`,\n      font-weight: 400;\n      padding: 8px;\n      box-sizing: border-box;\n    }\n\n    &__cell {\n      position: relative;\n      overflow: visible;\n\n      .resizer {\n        position: absolute;\n        top: 0;\n        bottom: 0;\n        right: -8px;\n        width: 8px;\n        background: transparent;\n        z-index: 10;\n        cursor: col-resize;\n      }\n    }\n  }\n\n  &__fields-reorder {\n    &__item {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    &__handle {\n      background-color: #f0f2f5;\n      height: 32px;\n      width: 32px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex-shrink: 0;\n    }\n\n    &__card {\n      &--dragging {\n        background-color: #f0f2f5;\n        box-shadow: var(--box-shadow-4);\n        user-select: none;\n      }\n    }\n  }\n}\n"],sourceRoot:""}]);const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___}}]);